!function(e){function webpackJsonpCallback(t){for(var i,o,n=t[0],r=t[1],h=0,l=[];h<n.length;h++)o=n[h],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&l.push(s[o][0]),s[o]=0;for(i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i]);for(a&&a(t);l.length;)l.shift()()}var t={},s={17:0};function __webpack_require__(s){if(t[s])return t[s].exports;var i=t[s]={i:s,l:!1,exports:{}};return e[s].call(i.exports,i,i.exports,__webpack_require__),i.l=!0,i.exports}__webpack_require__.e=function requireEnsure(e){var t=[],i=s[e];if(0!==i)if(i)t.push(i[2]);else{var o=new Promise((function(t,o){i=s[e]=[t,o]}));t.push(i[2]=o);var n,a=document.createElement("script");a.charset="utf-8",a.timeout=120,__webpack_require__.nc&&a.setAttribute("nonce",__webpack_require__.nc),a.src=function jsonpScriptSrc(e){return __webpack_require__.p+""+({18:"ffzap-core/vue"}[e]||e)+".aa32e2b26e42c0045038.js"}(e);var r=new Error;n=function(t){a.onerror=a.onload=null,clearTimeout(h);var i=s[e];if(0!==i){if(i){var o=t&&("load"===t.type?"missing":t.type),n=t&&t.target&&t.target.src;r.message="Loading chunk "+e+" failed.\n("+o+": "+n+")",r.name="ChunkLoadError",r.type=o,r.request=n,i[1](r)}s[e]=void 0}};var h=setTimeout((function(){n({type:"timeout",target:a})}),12e4);a.onerror=a.onload=n,document.head.appendChild(a)}return Promise.all(t)},__webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.d=function(e,t,s){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.t=function(e,t){if(1&t&&(e=__webpack_require__(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(__webpack_require__.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)__webpack_require__.d(s,i,function(t){return e[t]}.bind(null,i));return s},__webpack_require__.n=function(e){var t=e&&e.__esModule?function getDefault(){return e.default}:function getModuleExports(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="//cdn.frankerfacez.com/static/addons/",__webpack_require__.oe=function(e){throw console.error(e),e};var i=window.ffzAddonsWebpackJsonp=window.ffzAddonsWebpackJsonp||[],o=i.push.bind(i);i.push=webpackJsonpCallback,i=i.slice();for(var n=0;n<i.length;n++)webpackJsonpCallback(i[n]);var a=o;__webpack_require__(__webpack_require__.s=71)}({71:function(e,t,s){class FFZAP extends FrankerFaceZ.utilities.addon.Addon{constructor(...e){super(...e),this.inject("settings"),this.inject("chat"),this.inject("chat.emotes"),this.inject("chat.badges"),this.inject("site"),this.helpers={26964566:{title:"FFZ:AP Developer"},11819690:{title:"FFZ:AP Helper"},36442149:{title:"FFZ:AP Helper"},29519423:{title:"FFZ:AP Helper"},22025290:{title:"FFZ:AP Helper"},4867723:{title:"FFZ:AP Helper"}},this.supporters={},this.added_supporters=[],this.settings.add("ffzap.core.remove_spaces",{default:!1,ui:{path:"Add-Ons > FFZ:AP Core >> Emotes",title:"Remove Spaces Between Emotes",description:"Remove spaces inbetween emotes when they are right after one another. (e.g. combo emotes)",component:"setting-check-box"}}),this.settings.add("ffzap.core.message_deletion",{default:0,ui:{path:"Add-Ons > FFZ:AP Core >> Chat",title:"Message User-Level Filtering",description:"Messages will be removed from chat entirely if they aren't sent by a user of this level or higher.",component:"setting-select-box",data:[{value:0,title:"Display All Messages"},{value:1,title:"Display Subscriber Messages"},{value:2,title:"Display Moderator Messages"}]}}),this.settings.add("ffzap.core.enable_highlight_sound",{default:!1,requires:["ffzap.core.highlight_sound_types"],process(e,t){const s=e.get("ffzap.core.highlight_sound_types");return!(!Array.isArray(s)||!s.length)&&t},ui:{sort:-10,path:"Add-Ons > FFZ:AP Core >> Highlight Sounds",title:"Enable Highlight Sound",description:"Hear a sound every time a message is highlighted.",component:"setting-check-box"}}),this.settings.add("ffzap.core.highlight_sound",{default:"https://cdn.ffzap.com/sounds/default_wet.mp3",ui:{sort:-5,path:"Add-Ons > FFZ:AP Core >> Highlight Sounds",title:"Sound",description:"Change the sound that will play when a sound trigger is activated.",component:()=>s.e(18).then(s.bind(null,92)),no_i18n:!0,data:[{value:"https://cdn.ffzap.com/sounds/default_wet.mp3",title:"Default - Wet"},{value:"https://cdn.ffzap.com/sounds/default_graceful.mp3",title:"Default - Graceful"},{value:"https://cdn.ffzap.com/sounds/default_blocker.mp3",title:"Default - Blocker"},{value:"https://cdn.ffzap.com/sounds/coin.mp3",title:"Mario - Coin Sound"},{value:"https://cdn.ffzap.com/sounds/recovery.mp3",title:"Pokemon - Recovery"},{value:"https://cdn.ffzap.com/sounds/icq.mp3",title:"ICQ - Notification"},{value:"https://cdn.ffzap.com/sounds/aol.mp3",title:"AOL - You've got mail!"},{value:"https://cdn.ffzap.com/sounds/mailmf.mp3",title:"Euro Trip - Mail Motherf**ker!"},{value:"https://cdn.ffzap.com/sounds/zelda_secret.mp3",title:"Zelda - Secret Sound"},{value:"https://cdn.ffzap.com/sounds/brainpower.mp3",title:"O-oooooooooo AAAAE-A-A-I-A-U"},{value:"https://cdn.ffzap.com/sounds/the_best.mp3",title:"THE BEST THE BEST"},{value:"https://cdn.ffzap.com/sounds/wow.mp3",title:"WOW!"},{value:"https://cdn.ffzap.com/sounds/vsauce.mp3",title:"Hey Vsauce, Michael here."},{value:"https://cdn.ffzap.com/sounds/number_1.mp3",title:"We are number one, HEY!"},{value:"https://cdn.ffzap.com/sounds/hello.mp3",title:"Hello.webm"},{value:"https://cdn.ffzap.com/sounds/tuturu.mp3",title:"Tuturu~~"},{value:"https://cdn.ffzap.com/sounds/omae_wa_mou_shindeiru.mp3",title:"Omae wa mou shindeiru"},{value:"https://cdn.ffzap.com/sounds/never_asked_for_this.mp3",title:"I never asked for this."},{value:"https://cdn.ffzap.com/sounds/nani.mp3",title:"N-NANI?!"},{value:"https://cdn.ffzap.com/sounds/oh_no.mp3",title:"Knuckles - Oh no"},{value:"https://cdn.ffzap.com/sounds/whats_going_on.mp3",title:"He-Man - What's going on?!"},{value:"https://cdn.ffzap.com/sounds/gnome.mp3",title:"Gnome"},{value:"https://cdn.ffzap.com/sounds/oof.mp3",title:"Roblox Death Sound (OOF)"}],onUIChange:(e,t)=>e&&this.playPreviewSound(t,e,null),buttons:()=>s.e(18).then(s.bind(null,93))}}),this.settings.add("ffzap.core.highlight_sound_volume",{default:50,ui:{sort:-4,path:"Add-Ons > FFZ:AP Core >> Highlight Sounds",title:"Highlight Sound Volume",description:"Change the volume at which the highlight sounds will be played at.",component:"setting-select-box",data:[{value:5,title:"5%"},{value:10,title:"10%"},{value:20,title:"20%"},{value:30,title:"30%"},{value:40,title:"40%"},{value:50,title:"50%"},{value:60,title:"60%"},{value:70,title:"70%"},{value:80,title:"80%"},{value:90,title:"90%"},{value:100,title:"100%"}],onUIChange:(e,t)=>this.playPreviewSound(t,null,e)}}),this.settings.add("ffzap.core.highlight_sound_prevent_own_channel",{default:!1,ui:{path:"Add-Ons > FFZ:AP Core >> Highlight Sounds >> Sound Trigger Settings",title:"Prevent In Own Channel",description:"Prevent the sound from playing in your own channel.",component:"setting-check-box"}}),this.settings.add("ffzap.core.highlight_sound_types",{default:["badge","mention","term","user"],type:"basic_array_merge",ui:{path:"Add-Ons > FFZ:AP Core >> Highlight Sounds >> Sound Trigger Settings",title:"Play When",description:"Play a highlight sound when a chat line is highlighted for one of the selected reasons.",component:"setting-select-box",multiple:!0,data:()=>this.chat.getHighlightReasons()}}),this.chat.context.on("changed:ffzap.core.highlight_sound",async e=>{this.highlight_sound.src=await this.getSoundURL(e)},this),this.chat.context.on("changed:ffzap.core.highlight_sound_volume",e=>{this.highlight_sound.volume=e/100},this),this.setupHighlightSound(),this.remove_spaces_tokenizer={type:"remove_spaces",priority:-100,process:e=>{if(!e||!e.length)return e;if(!this.chat.context.get("ffzap.core.remove_spaces"))return e;const t=[];let s;for(let i=0,o=e.length;i<o;i++){const n=e[i];"text"===n.type&&" "===n.text&&"emote"===s&&i+1<o&&"emote"===e[i+1].type?i-1>=0&&(e[i-1].text+=" "):(s=n.type,t.push(n))}return t}},this.receive_event=!1,this.buffer_event=!1,this.updateEvents(),this.chat.context.on("changed:ffzap.core.message_deletion",this.updateEvents,this),this.chat.context.on("changed:ffzap.core.enable_highlight_sound",this.updateEvents,this),this.chat.addTokenizer(this.remove_spaces_tokenizer)}onEnable(){this.log.debug("FFZ:AP's Core module was enabled successfully."),this.fetchSupporters()}updateEvents(){const e=this.chat.context.get("ffzap.core.enable_highlight_sound"),t=this.chat.context.get("ffzap.core.message_deletion");e&&!this.buffer_event?this.on("chat:buffer-message",this.onBufferMessage,this):!e&&this.buffer_event&&this.off("chat:buffer-message",this.onBufferMessage,this),t&&!this.receive_event?this.on("chat:receive-message",this.onReceiveMessage,this):!t&&this.receive_event&&this.off("chat:receive-message",this.onReceiveMessage,this),this.buffer_event=e,this.receive_event=t}isModeratorOrHigher(e){return"broadcaster"in e||"staff"in e||"admin"in e||"global_mod"in e||"moderator"in e}handleMessageDeletion(e){const t=this.chat.context.get("ffzap.core.message_deletion"),s=e.message.badges;1==t?"subscriber"in s||this.isModeratorOrHigher(s)||(e.message.ffz_removed=!0):2!=t||this.isModeratorOrHigher(s)||(e.message.ffz_removed=!0)}async setupHighlightSound(){this.highlight_sound=new Audio(await this.getSoundURL(this.chat.context.get("ffzap.core.highlight_sound"))),this.highlight_sound.volume=this.chat.context.get("ffzap.core.highlight_sound_volume")/100}async getSoundURL(e){if(e.startsWith("ffzap.sound-file:")){const t=this.settings.provider,s=await t.getBlob(e);e=URL.createObjectURL(s)}return e}getElementSetting(e,t){return e&&e.profile.get(t)||this.chat.context.get(t)}async playPreviewSound(e,t,s){let i;null==t&&(t=this.getElementSetting(e,"ffzap.core.highlight_sound")),t=await this.getSoundURL(t),this._preview_sound?(i=this._preview_sound,i.pause(),i.src=t,i.currentTime=0):i=this._preview_sound=new Audio(t),i.volume=(null!=s?s:this.getElementSetting(e,"ffzap.core.highlight_sound_volume"))/100,i.play()}playHighlightSound(){this.highlight_sound.paused||this.highlight_sound.pause(),this.highlight_sound.play()}onReceiveMessage(e){this.handleMessageDeletion(e)}onBufferMessage(e){if(this.chat.context.get("ffzap.core.enable_highlight_sound")&&e.message.mentioned){if(this.chat.context.get("ffzap.core.highlight_sound_prevent_own_channel")){const t=this.resolve("site").getUser();if(t&&e.channel==t.login)return}const t=e.message.highlights;if(!t||!t.size)return;const s=this.chat.context.get("ffzap.core.highlight_sound_types");for(const e of s)if(t.has(e)){this.playHighlightSound();break}}}getBuster(e=5){const t=Math.floor(Date.now()/1e3);return t-t%e}async fetchSupporters(){const e="https://api.ffzap.com/v1/supporters?_="+this.getBuster(30),t={id:"supporter",title:"FFZ:AP Supporter",color:"#755000",slot:6,image:"https://api.ffzap.com/v1/user/badge/default/1",urls:{1:"https://api.ffzap.com/v1/user/badge/default/1",2:"https://api.ffzap.com/v1/user/badge/default/2",4:"https://api.ffzap.com/v1/user/badge/default/3"},click_url:"https://ffzap.com/"},s=await fetch(e);if(s.ok){const e=await s.json();this.badges.loadBadgeData("addon--ffzap.core--badges-supporter",t);for(let s=0;s<e.length;s++){const i=e[s];if(26964566===i.id)continue;if(!i.tier)continue;const o=this.chat.getUser(i.id),n={title:this.helpers[i.id]&&this.helpers[i.id].title||"FFZ:AP Supporter",color:i.tier>=2&&i.badge_color||t.color,image:`https://api.ffzap.com/v1/user/badge/${i.id}/1`,urls:{1:`https://api.ffzap.com/v1/user/badge/${i.id}/1`,2:`https://api.ffzap.com/v1/user/badge/${i.id}/2`,4:`https://api.ffzap.com/v1/user/badge/${i.id}/3`},click_url:"https://ffzap.com/"};i.tier>=3&&i.badge_is_colored&&(n.color="transparent",n.no_invert=!0),o.addBadge("addon--ffzap.core","addon--ffzap.core--badges-supporter",n),this.added_supporters.push(i.id)}}}}FFZAP.register("ffzap-core")}});
//# sourceMappingURL=script.aa32e2b26e42c0045038.js.map