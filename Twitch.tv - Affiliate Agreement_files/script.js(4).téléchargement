!function(a){var h={};function __webpack_require__(c){if(h[c])return h[c].exports;var l=h[c]={i:c,l:!1,exports:{}};return a[c].call(l.exports,l,l.exports,__webpack_require__),l.l=!0,l.exports}__webpack_require__.m=a,__webpack_require__.c=h,__webpack_require__.d=function(a,h,c){__webpack_require__.o(a,h)||Object.defineProperty(a,h,{enumerable:!0,get:c})},__webpack_require__.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},__webpack_require__.t=function(a,h){if(1&h&&(a=__webpack_require__(a)),8&h)return a;if(4&h&&"object"==typeof a&&a&&a.__esModule)return a;var c=Object.create(null);if(__webpack_require__.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:a}),2&h&&"string"!=typeof a)for(var l in a)__webpack_require__.d(c,l,function(h){return a[h]}.bind(null,l));return c},__webpack_require__.n=function(a){var h=a&&a.__esModule?function getDefault(){return a.default}:function getModuleExports(){return a};return __webpack_require__.d(h,"a",h),h},__webpack_require__.o=function(a,h){return Object.prototype.hasOwnProperty.call(a,h)},__webpack_require__.p="//cdn.frankerfacez.com/static/addons/",__webpack_require__(__webpack_require__.s=73)}({16:function(a,h,c){
/*!
 * displacejs.js 1.3.2 - Tiny javascript library to create moveable DOM elements.
 * Copyright (c) 2019 Catalin Covic - https://github.com/catc/displace
 * License: MIT
 */
a.exports=function(a){function t(c){if(h[c])return h[c].exports;var l=h[c]={exports:{},id:c,loaded:!1};return a[c].call(l.exports,l,l.exports,t),l.loaded=!0,l.exports}var h={};return t.m=a,t.c=h,t.p="",t(0)}([function(a,h,c){"use strict";var l=function n(a){return a&&a.__esModule?a:{default:a}}(c(1));a.exports=l.default},function(a,h,c){"use strict";function s(){var a=this,h=this.el,c=this.opts||p,m={};if(h.style.position="absolute",this.handle=c.handle||h,c.constrain){for(var g=c.relativeTo||h.parentNode,v=h,_=0,b=0;v!==g;)v=v.parentNode,(0,l.isRelative)(v)&&(_-=v.offsetLeft,b-=v.offsetTop),v===g&&(_+=v.offsetLeft,b+=v.offsetTop);var y=_+g.offsetWidth-h.offsetWidth,w=b+g.offsetHeight-h.offsetHeight;m.xClamp=(0,l.generateClamp)(_,y),m.yClamp=(0,l.generateClamp)(b,w)}this.opts=c,this.data=m,this.events={mousedown:d.mousedown.bind(this),mouseup:d.mouseup.bind(this),touchstart:d.touchstart.bind(this),touchstop:d.touchstop.bind(this),scrollFix:function(h){a.isDragging&&h.preventDefault()}},this.handleMove=f(this.opts.customMove),this.handle.addEventListener("mousedown",this.events.mousedown,!1),this.handle.addEventListener("touchstart",this.events.touchstart,!1),document.addEventListener("touchmove",this.events.scrollFix,{passive:!1})}Object.defineProperty(h,"__esModule",{value:!0});var l=c(2),d=c(3),f=(0,l.generateMoveFn)(),p={constrain:!1,relativeTo:null,handle:null,ignoreFn:null,highlightInputs:!1,onMouseDown:null,onMouseMove:null,onMouseUp:null,onTouchStart:null,onTouchMove:null,onTouchStop:null,customMove:null},m=function(){function e(a,h){if(function n(a,h){if(!(a instanceof h))throw new TypeError("Cannot call a class as a function")}(this,e),!a)throw Error("Must include moveable element");this.el=a,this.opts=h,s.call(this)}return e.prototype.reinit=function(){this.destroy(),s.call(this)},e.prototype.destroy=function(){var a=this.events;this.handle.removeEventListener("mousedown",a.mousedown,!1),document.removeEventListener("mousemove",a.mousemove,!1),document.removeEventListener("mouseup",a.mouseup,!1),this.handle.removeEventListener("touchstart",a.touchstart,!1),document.removeEventListener("touchmove",a.touchmove,!1),document.removeEventListener("touchstop",a.touchstop,!1),document.removeEventListener("touchmove",this.events.scrollFix,{passive:!1})},e}();h.default=function(a,h){return new m(a,h)}},function(a,h){"use strict";function i(a,h,c){a.style.left=h+"px",a.style.top=c+"px"}Object.defineProperty(h,"__esModule",{value:!0}),h.generateClamp=function o(a,h){return function(c){return Math.min(Math.max(c,a),h)}},h.isRelative=function n(a){return"relative"===window.getComputedStyle(a).position},h.generateMoveFn=function s(){return window.requestAnimationFrame?function(a){var h=a||i;return function(a,c,l){window.requestAnimationFrame((function(){h(a,c,l)}))}}:function(a){return function(h,c,l){(a||i)(h,c,l)}}}},function(a,h){"use strict";function n(a,h,c){var l=this.el,d=this.opts,f=this.data;"function"==typeof d.onMouseMove&&d.onMouseMove(l,c);var p=c.clientX-a,m=c.clientY-h;return d.constrain&&(p=f.xClamp(p),m=f.yClamp(m)),this.handleMove(l,p,m),c.preventDefault(),!1}function u(a,h,c){var l=this.el,d=this.opts,f=this.data;"function"==typeof d.onTouchMove&&d.onTouchMove(l,c);var p=c.targetTouches[0],m=p.clientX-a,g=p.clientY-h;return d.constrain&&(m=f.xClamp(m),g=f.yClamp(g)),this.handleMove(l,m,g),c.preventDefault(),!1}Object.defineProperty(h,"__esModule",{value:!0}),h.mousedown=function o(a){var h=this.opts;if(h.highlightInputs){var c=a.target.tagName.toLowerCase();if("input"===c||"textarea"===c)return}if(!h.ignoreFn||!h.ignoreFn(a)){if(0===a.button){var l=this.el,d=this.events;"function"==typeof h.onMouseDown&&h.onMouseDown(l,a);var f=a.clientX-l.offsetLeft,p=a.clientY-l.offsetTop;d.mousemove=n.bind(this,f,p),document.addEventListener("mousemove",d.mousemove,!1),document.addEventListener("mouseup",d.mouseup,!1)}a.preventDefault()}},h.mousemove=n,h.mouseup=function s(a){var h=this.el,c=this.opts,l=this.events;"function"==typeof c.onMouseUp&&c.onMouseUp(h,a),document.removeEventListener("mouseup",l.mouseup,!1),document.removeEventListener("mousemove",l.mousemove,!1)},h.touchstart=function i(a){var h=this.opts;if(h.highlightInputs){var c=a.target.tagName.toLowerCase();if("input"===c||"textarea"===c)return}if(!h.ignoreFn||!h.ignoreFn(a)){var l=this.el,d=this.events;"function"==typeof h.onTouchStart&&h.onTouchStart(l,a);var f=a.targetTouches[0],p=f.clientX-l.offsetLeft,m=f.clientY-l.offsetTop;d.touchmove=u.bind(this,p,m),this.isDragging=!0,document.addEventListener("touchmove",d.touchmove,!1),document.addEventListener("touchend",d.touchstop,!1),document.addEventListener("touchcancel",d.touchstop,!1)}},h.touchmove=u,h.touchstop=function r(a){this.isDragging=!1;var h=this.el,c=this.opts,l=this.events;"function"==typeof c.onTouchStop&&c.onTouchStop(h,a),document.removeEventListener("touchmove",l.touchmove,!1),document.removeEventListener("touchend",l.touchstop,!1),document.removeEventListener("touchcancel",l.touchstop,!1)}}])},17:function(a,h,c){a.exports=c.p+"fs-chat/styles.be8c2f064f6c935893c2fe9d0b0f2e17.css"},73:function(a,h,c){"use strict";c.r(h);var l,d,f=c(16),p=c.n(f),m=c(17),g=c.n(m);const{createElement:v,ManagedStyle:_}=FrankerFaceZ.utilities.dom,b=FrankerFaceZ.utilities.color.Color,y=v("span",null),w=null===(l=window.CSS)||void 0===l||null===(d=l.supports)||void 0===d?void 0:d.call(l,"backdrop-filter:blur(1px)"),S=["f","space","k","shift+up","shift+down","esc","m","?","alt+t","alt+x"];function isValidShortcut(a){return!!a&&(a=a.toLowerCase().trim(),!S.includes(a))}class FSChat extends FrankerFaceZ.utilities.addon.Addon{constructor(...a){super(...a),this.inject("site.fine"),this.inject("site.player"),this.inject("site.web_munch"),this.onFSChange=this.onFSChange.bind(this),this.onShortcut=this.onShortcut.bind(this),this.settings.addFilter("fschat",{createTest:a=>h=>h.fschat===a,title:"Using FS Chat",i18n:"addon.fs-chat.using",default:!0,editor:this.settings.getFilterBasicEditor()}),this.settings.add("addon.fs-chat.shortcut",{default:"alt+c",ui:{path:"Add-Ons > FS Chat >> Behavior",title:"Shortcut Key",description:"This key sequence can be used to toggle FS Chat when in fullscreen.",component:"setting-hotkey"},changed:()=>{this.updateShortcut(),this.updateButtons()}}),this.settings.add("addon.fs-chat.automatic",{default:!1,ui:{path:"Add-Ons > FS Chat >> Behavior",title:"Automatically open FS Chat when entering fullscreen.",component:"setting-check-box"}}),this.settings.add("addon.fs-chat.bg.color",{default:"rgba(0,0,0,0.50)",ui:{path:"Add-Ons > FS Chat >> Appearance",title:"Background Color",component:"setting-color-box",alpha:!0},changed:()=>this.updateCSS()}),this.settings.add("addon.fs-chat.hide-scroll",{default:!1,ui:{path:"Add-Ons > FS Chat >> Appearance",title:"Hide Chat Scroll Bar",component:"setting-check-box"},changed:a=>this.chat&&this.chat.classList.toggle("hide-scroll",a)}),w&&this.settings.add("addon.fs-chat.bg.blur",{default:5,ui:{path:"Add-Ons > FS Chat >> Appearance",title:"Background Blur",description:"**Note:** Blur may cause performance issues depending on your browser and PC specs.",component:"setting-select-box",data:[{value:0,title:"Disabled"},{value:2,title:"Minor (2px)"},{value:5,title:"Normal (5px)"},{value:10,title:"Large (10px)"},{value:50,title:"Extreme (50px)"}]},changed:()=>this.updateCSS()}),this.settings.add("addon.fs-chat.height",{default:null,ui:{path:"Add-Ons > FS Chat >> Size and Position",title:"Height",description:"How tall FS Chat should be, in pixels. If you know CSS, you can enter a different unit.",component:"setting-text-box"},changed:()=>this.updateCSS()}),this.settings.add("addon.fs-chat.width",{default:null,requires:["chat.width"],process:(a,h)=>h||a.get("chat.width"),ui:{path:"Add-Ons > FS Chat >> Size and Position",title:"Width",description:"How wide FS Chat should be, in pixels. Defaults to normal chat width. If you know CSS, you can enter a different unit.",component:"setting-text-box"},changed:()=>this.updateCSS()}),this.settings.add("addon.fs-chat.minimal",{default:!0,ui:{path:"Add-Ons > FS Chat >> Appearance",sort:999,title:"Minimal Mode",component:"setting-check-box",description:"This hides the chat header and input buttons when FS Chat is open."},changed:a=>this.chat&&this.chat.classList.toggle("minimal",a)}),this.settings.add("addon.fs-chat.no-input",{default:!1,ui:{path:"Add-Ons > FS Chat >> Appearance",sort:1e3,title:"Do not display chat input.",component:"setting-check-box"},changed:a=>this.chat&&this.chat.classList.toggle("no-input",a)}),this.settings.add("addon.fs-chat.round",{default:!0,ui:{path:"Add-Ons > FS Chat >> Appearance",title:"Use rounded corners.",component:"setting-check-box"},changed:a=>this.chat&&this.chat.classList.toggle("no-rounding",!a)}),this.settings.add("addon.fs-chat.metadata",{default:2,ui:{path:"Add-Ons > FS Chat >> Appearance",title:"Metadata Position",component:"setting-select-box",data:[{value:0,title:"Disabled"},{value:1,title:"Above Chat"},{value:2,title:"Below Chat"}]},changed:()=>{this.chat&&(this.turnOff(),this.turnOn())}}),this.chat=null,this.handle_right=!1,this.style=new _,this.style_link=null}onEnable(){this.style_link||document.head.appendChild(this.style_link=v("link",{href:g.a,rel:"stylesheet",type:"text/css",crossOrigin:"anonymous"})),this.updateCSS(),window.addEventListener("fullscreenchange",this.onFSChange),this.on("site.player:update-gui",this.updateButton,this),this.settings.get("addon.fs-chat.automatic")&&this.turnOn(),this.updateButtons(),this.updateShortcut()}updateShortcut(){const a=this.Mousetrap=this.Mousetrap||this.web_munch.getModule("mousetrap")||window.Mousetrap;if(!a||!a.bind)return;this._shortcut_bound&&(a.unbind(this._shortcut_bound),this._shortcut_bound=null);const h=this.settings.get("addon.fs-chat.shortcut");h&&isValidShortcut(h)&&(a.bind(h,this.onShortcut),this._shortcut_bound=h)}onShortcut(){document.fullscreenElement&&(this.chat?this.turnOff():this.turnOn(),this.updateButtons())}updateCSS(){const a=w?this.settings.get("addon.fs-chat.bg.blur"):0;a>0?this.style.set("blur",`.ffz--fschat .ffz--meta-tray,.ffz--fschat .channel-root__right-column > div { backdrop-filter: blur(${a}px); }`):this.style.delete("blur"),y.style.width="",y.style.height="";let h=this.settings.get("addon.fs-chat.height")||"",c=this.settings.get("addon.fs-chat.width")||"340";/^\d+$/.test(h)&&(h+="px"),/^\d+$/.test(c)&&(c+="px"),y.style.width=c,y.style.height=h,c=y.style.width||"340px",h=y.style.height||"50vh",this.style.set("size",`.ffz--fschat {\n\twidth: ${c};\n\theight: ${h};\n}`);let l=b.RGBA.fromCSS(this.settings.get("addon.fs-chat.bg.color"));l||(l=b.RGBA.fromCSS("rgba(0,0,0,0.75)"));const d=l.toHSLA().l;this.dark=d<.5,this.chat&&(this.settings.updateContext({"force-theme":this.dark}),this.chat.classList.toggle("tw-root--theme-dark",this.dark),this.chat.classList.toggle("tw-root--theme-light",!this.dark)),this.style.set("color",`.ffz--fschat {\n\t--fschat-bg-color: ${l.toCSS()};\n}`)}turnOn(){if(document.fullscreenElement&&!this.chat){if(this.chat_pane=document.querySelector(".channel-root__right-column"),!this.chat_pane)return;this.old_parent=this.chat_pane.parentNode,this.chat_pane.remove();let a,h=this.settings.get("addon.fs-chat.metadata");0!==h&&(this.meta_pane=document.querySelector(".ffz--meta-tray"),this.meta_pane?(this.meta_parent=this.meta_pane.parentNode,this.meta_pane.remove()):h=0),this.chat=v("div",{class:`ffz--fschat meta-${h}${this.settings.get("addon.fs-chat.round")?"":" no-rounding"} ${this.settings.get("addon.fs-chat.no-input")?" no-input":""}${this.settings.get("addon.fs-chat.minimal")?" minimal":""}${this.settings.get("addon.fs-chat.hide-scroll")?" hide-scroll":""} ${this.dark?"tw-root--theme-dark":"tw-root--theme-light"} tw-c-text-base ${this.handle_right?"handle--right":""}`},a=v("div",{class:"handle ffz-i-move"}),this.chat_pane,this.meta_pane),this.chat.addEventListener("mouseout",()=>this.checkHandle()),this.settings.provider.has("fschat.top")&&(this.chat.style.position="absolute",this.chat.style.top=this.settings.provider.get("fschat.top"),this.chat.style.left=this.settings.provider.get("fschat.left"),this.checkConstraints(),this.checkHandle()),document.fullscreenElement.appendChild(this.chat);const savePos=()=>{const a=this.chat.style.top,h=this.chat.style.left;this.settings.provider.set("fschat.top",a),this.settings.provider.set("fschat.left",h)};this.chat_mover=p()(this.chat,{handle:a,constrain:!0,onMouseUp:savePos,onTouchStop:savePos}),this.settings.updateContext({fschat:!0,"force-theme":this.dark}),this.scroll_frame||(this.scroll_frame=requestAnimationFrame(()=>{this.scroll_frame=null;const a=this.chat&&this.chat.querySelector(".simplebar-scroll-content");a&&(a.scrollTop=a.scrollHeight)}))}}checkConstraints(){this._checker&&cancelAnimationFrame(this._checker),this._checker=requestAnimationFrame(()=>{if(this._checker=null,!this.chat||!document.fullscreenElement)return;const a=document.fullscreenElement.getBoundingClientRect(),h=this.chat.getBoundingClientRect();h.right>a.right&&(this.chat.style.left=a.right-h.width+"px",this.checkHandle()),h.bottom>a.bottom&&(this.chat.style.top=a.bottom-h.height+"px"),h.left<0&&(this.chat.style.left="0px",this.checkHandle()),h.top<0&&(this.chat.style.top="0px")})}checkHandle(){this._handle_checker&&cancelAnimationFrame(this._handle_checker),this._handle_checker=requestAnimationFrame(()=>{if(this._handle_checker=null,!this.chat||!document.fullscreenElement)return;const a=document.fullscreenElement.getBoundingClientRect(),h=this.chat.getBoundingClientRect();this.handle_right&&h.right>=a.right-40?this.handle_right=!1:!this.handle_right&&h.left<=a.left+40&&(this.handle_right=!0),this.chat.classList.toggle("handle--right",this.handle_right)})}turnOff(){this.chat_mover&&(this.chat_mover.destroy(),this.chat_mover=null),this.meta_pane&&(this.meta_pane.remove(),this.meta_parent.appendChild(this.meta_pane),this.meta_pane=this.meta_parent=null),this.chat&&(this.chat.remove(),this.chat_pane.remove(),this.old_parent.appendChild(this.chat_pane),this.old_parent=this.chat=this.chat_pane=null),this.settings.updateContext({fschat:!1,"force-theme":null})}onFSChange(){document.fullscreenElement?(this.was_active||this.settings.get("addon.fs-chat.automatic"))&&this.turnOn():(this.was_active=!!this.chat,this.turnOff()),this.updateButtons()}updateButtons(){for(const a of this.player.Player.instances)this.updateButton(a)}updateButton(a){var h,c,l;const d=a.props.containerRef||this.fine.getChildNode(a),f=(this.enabled||this.enabling)&&(null===(h=document.fullscreenElement)||void 0===h||null===(c=h.contains)||void 0===c?void 0:c.call(h,d)),p=null==d||null===(l=d.querySelector)||void 0===l?void 0:l.call(d,this.player.RIGHT_CONTROLS||".video-player__default-player .player-controls__right-control-group");if(!p)return;const m=this.chat||null!=document.querySelector(".channel-root__right-column");let g,_,b,y=p.querySelector(".ffz--player-fschat");if(!f||!m)return void(y&&y.remove());if(y)g=y.querySelector("figure"),b=y.querySelector("button"),_=y.querySelector(".ffz-il-tooltip");else{y=v("div",{class:"ffz--player-fschat tw-inline-flex tw-relative ffz-il-tooltip__container"},b=v("button",{class:"tw-align-items-center tw-align-middle tw-border-bottom-left-radius-medium tw-border-bottom-right-radius-medium tw-border-top-left-radius-medium tw-border-top-right-radius-medium tw-button-icon tw-button-icon--overlay ffz-core-button ffz-core-button--border ffz-core-button--overlay tw-inline-flex tw-interactive tw-justify-content-center tw-overflow-hidden tw-relative",type:"button","data-a-target":"ffz-player-fschat-button",onClick:this.onButtonClick.bind(this,a)},v("div",{class:"tw-align-items-center tw-flex tw-flex-grow-0"},v("div",{class:"tw-button-icon__icon"},g=v("figure",{class:"ffz-player-icon"})))),_=v("div",{class:"ffz-il-tooltip ffz-il-tooltip--align-right ffz-il-tooltip--up",role:"tooltip"}));const h=p.querySelector('button[data-a-target="player-fullscreen-button"]');h?p.insertBefore(y,h.parentElement):p.appendChild(y)}const w=null!=this.chat;let S=w?this.i18n.t("addon.fs-chat.button.active","Disable FS Chat"):this.i18n.t("addon.fs-chat.button.inactive","FS Chat");const C=this.settings.get("addon.fs-chat.shortcut");C&&isValidShortcut(C)&&(S=`${S} (${C})`),g.classList.toggle("ffz-i-chat-empty",!w),g.classList.toggle("ffz-i-chat",w),b.setAttribute("aria-label",S),_.textContent=S}onButtonClick(a,h){this.chat?this.turnOff():this.turnOn(),this.updateButton(a)}}FSChat.register("fs-chat")}});
//# sourceMappingURL=script.aa32e2b26e42c0045038.js.map